<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
<section id="wrap">
    <div id="mask">
        <div></div>
        <div></div>
        <span></span>
    </div>
    <header id="header">
       <div class="logo-nav">
           <div class="logo">
               <h1>
                   <img src="img/logo.png" alt="">
               </h1>
           </div>
           <div class="music">
               <audio src="img/audio.mp3"></audio>
           </div>
           <nav class="nav">
               <ul class="clearfix">
                   <li class="home">
                       <a href="javascript:;">
                           <div class="up">
                               <img src="img/home.png" alt="">
                           </div>
                           <div class="down">
                               <img src="img/home_gruen.png" alt="">
                           </div>
                       </a>
                   </li>
                   <li class="course">
                       <a href="javascript:;">
                           <div class="up">Course</div>
                           <div class="down">Course</div>
                       </a>
                   </li>
                   <li class="works">
                       <a href="javascript:;">
                           <div class="up">Works</div>
                           <div class="down">Works</div>
                       </a>
                   </li>
                   <li class="about">
                       <a href="javascript:;">
                           <div class="up">About</div>
                           <div class="down">About</div>
                       </a>
                   </li>
                   <li class="team">
                       <a href="javascript:;">
                           <div class="up">Team</div>
                           <div class="down">Team</div>
                       </a>
                   </li>
               </ul>
           </nav>
       </div>
       <div class="arrow">
           <img src="img/arrow.png" alt="">
       </div>
   </header>
    <section id="content">
        <ul class="list">
            <li class="home">
                <div>
                    <ul class="home1">
                        <!--点击右边的时候 leftHide rightShow-->
                        <!--点击左边的时候 leftShow rightHide-->

                        <li>
                            <div class="commonTitle">one layer</div>
                        </li>
                        <li>
                            <div class="commonTitle">two layer</div>
                        </li>
                        <li>
                            <div class="commonTitle">three layer</div>
                        </li>
                        <li>
                            <div class="commonTitle">four layer</div>
                        </li>
                    </ul>
                    <ul class="home2">
                        <li class="active"></li>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                </div>
            </li>
            <li class="course">
                <div>
                    <p class="course1 commonTitle">
                        <span>EINIGE</span><br>
                        <span>UNSERER</span><br>
                        <span>KUNDEN</span>
                    </p>
                    <div class="course2 commonText">
                        <p>
                            Das Kundenvertrauen in unsere Kompetenz ist die notwendige Basis einer erfolgreichen Zusammenarbeit, gleichzeitig aber auch das größte Lob, das man uns entgegenbringen kann.
                        </p>
                        <p>
                            Diese und viele weitere große und kleine Kunden vertrauen uns seit Jahren, was uns stolz macht, und dafür sagen wir an dieser Stelle einfach mal.
                        </p>
                    </div>
                    <div class="course3">
                        <ul class="item clearfix">
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                            <li>
                                <div class="img">一棵是枣树，另一棵也是枣树</div>
                                <div class="text"></div>
                            </li>
                        </ul>
                        <ul class="line">
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                        </ul>
                    </div>
                    <div class="plane1"></div>
                    <div class="plane2"></div>
                    <div class="plane3"></div>
                </div>
            </li>
            <li class="works">
                <div>
                    <p class="works1 commonTitle">
                        <span>EINBLICK</span><br>
                        <span>ERKENNTNIS</span><br>
                        <span>ERGEBNIS</span>
                    </p>
                    <ul class="works2 clearfix">
                        <li>
                            <img src="img/worksimg1.jpg" alt="">
                            <div class="mask">
                                <p>我的后花园</p>
                                <div class="icon"></div>
                            </div>
                        </li>
                        <li>
                            <img src="img/worksimg2.jpg" alt="">
                            <div class="mask">
                                <p>我的后花园</p>
                                <div class="icon"></div>
                            </div>
                        </li>
                        <li>
                            <img src="img/worksimg3.jpg" alt="">
                            <div class="mask">
                                <p>我的后花园</p>
                                <div class="icon"></div>
                            </div>
                        </li>
                        <li>
                            <img src="img/worksimg4.jpg" alt="">
                            <div class="mask">
                                <p>我的后花园</p>
                                <div class="icon"></div>
                            </div>
                        </li>
                    </ul>
                    <div class="works3"></div>
                    <div class="pencel1"></div>
                    <div class="pencel2"></div>
                    <div class="pencel3"></div>
                </div>
            </li>
            <li class="about">
                <div>
                    <p class="about1 commonTitle">
                        <span>DIE</span><br>
                        <span>SPEZIELLE</span><br>
                        <span>VIELFALT</span>
                    </p>
                    <div class="about2 commonText">
                        <p>
                            Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.
                        </p>
                    </div>
                    <div class="line"></div>
                    <div class="about3">
                        <div class="item">
                            <span></span>
                            <ul data-img="img/about1.jpg"></ul>
                        </div>
                        <div class="item">
                            <span></span>
                            <ul data-img="img/about3.jpg"></ul>
                        </div>
                    </div>
                </div>
            </li>
            <li class="team">
                <div>
                    <p class="team1 commonTitle">
                        <span>WIR SIND</span><br>
                        <span>VOXELAIR</span>
                    </p>
                    <div class="team2 commonText">
                        <p>
                            Wir sind seit 2002 eine Full-Service-Werbeagentur mit Stammsitz in Heimsheim, zwischen Stuttgart und Karlsruhe.
                        </p>
                        <p>
                            Über 60 Jahre Erfahrung vereinen das gesamte VoxelAir-Team. Dabei hat jedes Voxel neben professionellem Allroundwissen auch sein ganz spezielles Gebiet, um selbst die individuellsten Kundenwünsche schnell und kompetent umzusetzen.
                        </p>
                    </div>
                    <div class="team3">
                        <ul class="clearfix">
                            <li></li>
                            <li></li>
                            <li></li>
                            <li></li>
                        </ul>
                    </div>
                </div>
            </li>
        </ul>
        <ul class="menuList">
            <li class="active"></li>
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </section>
</section>
<script>
    window.onload = function () {
        var arrow = document.querySelector("#header .arrow");
        var headerLis = document.querySelectorAll("#header .logo-nav .nav li");
        var downs = document.querySelectorAll("#header .logo-nav .nav li .down");

        var header = document.getElementById("header");
        var content = document.getElementById("content");
        var contentLi = document.querySelectorAll("#content .list>li");
        var list = document.querySelector("#content .list");

        var now = 0;
        var timer = null;

        var aboutUl = document.querySelectorAll("#content .list .about>div .about3 .item ul")

        var homeLi = document.querySelectorAll("#content .list .home>div .home1 li");
        var homeSmallLi = document.querySelectorAll("#content .list .home>div .home2 li");

        var oldIndex =0;
        var autoIndex = 0;
        var HomeTimer1 = null;

        var team3 = document.querySelector("#content .list .team>div .team3");
        var teamLi = document.querySelectorAll("#content .list .team>div .team3 li")


        var menuListLi = document.querySelectorAll("#content .menuList>li");


        var music = document.querySelector("#header .logo-nav .music");
        var audio = document.querySelector("#header .logo-nav .music audio");

        var maskBig = document.querySelector("#mask");
        var maskDiv = document.querySelectorAll("#mask>div");
        var maskSpan = document.querySelector("#mask>span");

        onPlay();
        function onPlay() {
            var arr = ['bg1.jpg','bg2.jpg','bg3.jpg','bg4.jpg','bg5.jpg','about1.jpg','about2.jpg','about3.jpg','about4.jpg','worksimg1.jpg','worksimg2.jpg','worksimg3.jpg','worksimg4.jpg','team.png','greenLine.png'];
            var imgFlag = 0;
            for(var i=0;i<arr.length;i++){
                var img = new Image();
                img.src = "img/"+arr[i];
                img.onload = function () {
                    imgFlag++;
                    maskSpan.style.width = imgFlag/arr.length*100 + "%";
                }
            }
            maskSpan.addEventListener("transitionend",function () {
                if(imgFlag/arr.length == 1){
                    maskDiv[0].style.height = "0";
                    maskDiv[1].style.height = "0";
                    maskSpan.style.display = "none"
                }

            });

            maskDiv[0].addEventListener("transitionend",function () {
                maskBig.remove();
                animation[0].inAni();
                music.onclick();
                homeBind();

            })

        }
        var prevIndex = 0;
        var animation = [
            {
                inAni:function () {
                    var home1 = document.querySelector("#content .list .home>div .home1");
                    var home2 = document.querySelector("#content .list .home>div .home2");
                    home1.style.transform = "translateY(0px)";
                    home2.style.transform = "translateY(0px)";
                    home1.style.opacity = "1";
                    home2.style.opacity = "1";
                },
                outAni:function () {
                    var home1 = document.querySelector("#content .list .home>div .home1");
                    var home2 = document.querySelector("#content .list .home>div .home2");
                    home1.style.transform = "translateY(-200px)";
                    home2.style.transform = "translateY(200px)";
                    home1.style.opacity = "0";
                    home2.style.opacity = "0";
                }
            },
            {
                inAni:function () {
                    var plane1 = document.querySelector("#content .list .course>div .plane1");
                    var plane2 = document.querySelector("#content .list .course>div .plane2");
                    var plane3 = document.querySelector("#content .list .course>div .plane3");
                    plane1.style.transform = "translate(0px,0px)";
                    plane2.style.transform = "translate(0px,0px)";
                    plane3.style.transform = "translate(0px,0px)";


                    },
                outAni:function () {
                    var plane1 = document.querySelector("#content .list .course>div .plane1");
                    var plane2 = document.querySelector("#content .list .course>div .plane2");
                    var plane3 = document.querySelector("#content .list .course>div .plane3");
                    plane1.style.transform = "translate(-200px,-200px)";
                    plane2.style.transform = "translate(-200px,200px)";
                    plane3.style.transform = "translate(200px,-200px)";
                }

            },
            {
                inAni:function () {
                    var pencel1 =document.querySelector("#content .list .works>div .pencel1");
                    var pencel2 =document.querySelector("#content .list .works>div .pencel2");
                    var pencel3 =document.querySelector("#content .list .works>div .pencel3");
                    pencel1.style.transform = "translateY(0px)";
                    pencel2.style.transform = "translateY(0px)";
                    pencel3.style.transform = "translateY(0px)";


                    },
                outAni:function () {
                    var pencel1 =document.querySelector("#content .list .works>div .pencel1");
                    var pencel2 =document.querySelector("#content .list .works>div .pencel2");
                    var pencel3 =document.querySelector("#content .list .works>div .pencel3");
                    pencel1.style.transform = "translateY(-200px)";
                    pencel2.style.transform = "translateY(200px)";
                    pencel3.style.transform = "translateY(200px)";

                }
            },
            {
                inAni:function () {
                    var AboutItem = document.querySelectorAll("#content .list .about>div .about3 .item");
                    AboutItem[0].style.transform = "rotate(0deg)";
                    AboutItem[1].style.transform = "rotate(0deg)"
                },
                outAni:function () {
                    var AboutItem = document.querySelectorAll("#content .list .about>div .about3 .item");

                    AboutItem[0].style.transform = "rotate(30deg)";
                    AboutItem[1].style.transform = "rotate(-30deg)"
                }
            },
            {
                inAni:function () {
                    var team1 = document.querySelector("#content .list .team>div .team1");
                    var team2 = document.querySelector("#content .list .team>div .team2");
                    team1.style.transform = "translateX(0px)";
                    team2.style.transform = "translateX(0px)";
                },
                outAni:function () {
                    var team1 = document.querySelector("#content .list .team>div .team1");
                    var team2 = document.querySelector("#content .list .team>div .team2");
                    team1.style.transform = "translateX(-200px)";
                    team2.style.transform = "translateX(200px)";

                }
            }
        
        ];
        for(var i = 0;i<animation.length;i++){
            animation[i].outAni();
        }

        // // setInterval(function () {
        //     animation[0].inAni();
        // },1000);


        music.onclick = function () {
            if(audio.paused){
                audio.play();
                music.style.backgroundImage = "url(img/musicon.gif)";
            }else {
                audio.pause();
                music.style.backgroundImage = "url(img/musicoff.gif)";
            }
        };




        teamBind();
        function teamBind() {
            var canvas = null;
            var teamTimer1 = 0;
            var teamTimer2 = 0;

            team3.onmouseleave = function () {
                for(var j =0;j<teamLi.length;j++){
                    teamLi[j].style.opacity = "1"
                }
                removeCanvas();

            };
            for(var i =0;i<teamLi.length;i++){
                teamLi[i].onmouseenter = function () {
                    for(var j =0;j<teamLi.length;j++){
                        teamLi[j].style.opacity = "0.5"
                    }
                    this.style.opacity = "1" ;

                    addCanvas();

                    canvas.style.left = this.offsetLeft + "px";

                }
            }
            function removeCanvas() {
                clearInterval(teamTimer1);
                clearInterval(teamTimer2);
                canvas.remove();
                canvas = null;
            }

            function addCanvas() {
                if(!canvas){
                    canvas = document.createElement("canvas");
                    canvas.width = teamLi[0].offsetWidth;
                    canvas.height = 320;
                    team3.appendChild(canvas);
                    qiPao(canvas);
                }
            }
            function qiPao(canvas) {
                var ctx = canvas.getContext("2d");
                var arr = [];

                teamTimer1=setInterval(function () {
                    ctx.clearRect(0,0,canvas.width,canvas.height);
                    for(var i =0 ;i< arr.length;i++) {
                        arr[i].deg += 3;
                        arr[i].x = arr[i].startX + 0.5*Math.sin(arr[i].deg * Math.PI / 180) * arr[i].num;
                        arr[i].y = arr[i].startY - 0.5 * arr[i].deg * Math.PI / 180 * arr[i].num;
                        if (arr[i].y < 20) {
                            arr.splice(i, 1)
                        }
                    }

                    for (var i = 0; i < arr.length; i++) {
                        ctx.beginPath();
                        ctx.fillStyle = "rgba(" + arr[i].red + "," + arr[i].green + "," + arr[i].blue + "," + arr[i].a + ")";
                        ctx.arc(arr[i].x, arr[i].y, arr[i].r, 0, Math.PI * 2);
                        ctx.fill();
                    }
                },1000/60);


                teamTimer2 = setInterval(function () {
                    var r = Math.floor(Math.random()*8) + 3;
                    var x = Math.floor(Math.random()*canvas.width);
                    var y =canvas.height-r-2;
                    var red = Math.floor(Math.random()*255);
                    var green = Math.floor(Math.random()*255);
                    var blue = Math.floor(Math.random()*255);

                    var a = 0.5;
                    var startX = x;
                    var startY = y;
                    var deg = 0;
                    var num = Math.floor(Math.random()*30)+30;

                    arr.push(
                        {
                            x:x,
                            y:y,
                            r:r,
                            red:red,
                            green:green,
                            blue:blue,
                            a:a,
                            startX :startX,
                            startY :startY,
                            deg: deg,
                            num :num

                        }

                    ) ;
                },50)

            }

        }

        homeBind();
        function homeBind() {
            for(var i =0;i<homeSmallLi.length;i++){
                homeSmallLi[i].index = i;

                homeSmallLi[i].onclick = function () {

                    clearInterval(HomeTimer1);

                    for(var j =0 ;j<homeSmallLi.length;j++){
                        homeSmallLi[j].className = "";
                    }
                    this.className = "active";

                    if(oldIndex < this.index){
                        homeLi[oldIndex].className = "leftHide";
                        homeLi[this.index].className = "rightShow";
                    }else if(oldIndex > this.index){
                        homeLi[oldIndex].className = "rightHide";
                        homeLi[this.index].className = "leftShow";
                    }
                    oldIndex = this.index;
                    autoIndex = this.index;
                    autoPlay();
                }
            }

            autoPlay();
            function autoPlay() {
                clearInterval(HomeTimer1);
                HomeTimer1 = setInterval(function () {
                    autoIndex++;
                    if(autoIndex == homeLi.length){
                        autoIndex = 0;
                    }
                    homeLi[autoIndex].className = "rightShow";
                    homeLi[oldIndex].className = "leftHide";
                    for(var j =0 ;j<homeSmallLi.length;j++){
                        homeSmallLi[j].className = "";
                    }
                    homeSmallLi[autoIndex].className = "active";

                    oldIndex = autoIndex;
                },2000)

            }
        }

        aboutBind();
        function aboutBind() {
            for(var i = 0;i<aboutUl.length;i++){
                changImg(aboutUl[i]);
            }
            function changImg(Ul) {
                var w = Ul.offsetWidth/2;
                var h = Ul.offsetHeight/2;
                for(var i =0 ;i<4;i++){
                    var liNode = document.createElement("li");
                    var imgNode = document.createElement("img");
                    liNode.style.width = w +"px";
                    liNode.style.height = h +"px";

                    imgNode.src = Ul.dataset.img;
                    imgNode.style.left = -i%2 * w + "px";
                    imgNode.style.top = -Math.floor(i/2 )* h + "px";


                    Ul.appendChild(liNode);
                    liNode.appendChild(imgNode)
                }
                var imgNodes = Ul.querySelectorAll("img");
                // console.log(imgNodes.length);
                Ul.onmouseenter = function () {
                    imgNodes[0].style.top = h + "px";
                    imgNodes[1].style.left = -2*w + "px";
                    imgNodes[2].style.left = w + "px";
                    imgNodes[3].style.top= -2*h + "px";

                }
                Ul.onmouseleave = function () {
                    imgNodes[0].style.top = 0 + "px";
                    imgNodes[1].style.left = -w + "px";
                    imgNodes[2].style.left = 0 + "px";
                    imgNodes[3].style.top = -h + "px";
                }
            }

        }

        wheel();
        function wheel() {
            content.onmousewheel = function (event) {
                clearTimeout(timer);
                timer = setTimeout(function () {
                    fun(event);
                },200)
            };
            if(content.addEventListener){
                content.addEventListener("DOMMouseScroll",function (event) {
                    clearTimeout(timer);
                    timer = setTimeout(function () {
                        fun(event);
                    },200)
                });
            }
            function fun(event) {
                event = event || window.event;
                var flag = "";
                if (event.wheelDelta){
                    if(event.wheelDelta>0){
                        flag = "up";
                    }else {
                        flag = "down"
                    }
                }else if(event.detail){
                    if(event.detail<0){
                        flag = "up"
                    }else {
                        flag = "down"
                    }
                }
                prevIndex = now;
                if(((now == headerLis.length-1)&&flag == "down")||(now == 0)&&flag == "up"){
                    return;
                }
                switch (flag){
                    case "up":
                        if(now > 0){
                            now--
                        }
                        move(now);
                        break;
                    case "down":
                        if(now < headerLis.length-1 ){
                            now++;
                        }
                        move(now);
                        break;
                }
                event.preventDefault && event.preventDefault();
                return false;
            }
        }

        window.onresize = function () {
            contentBind();
            arrow.style.left = headerLis[0].getBoundingClientRect().left
                + headerLis[0].offsetWidth/2 - arrow.offsetWidth/2 + "px";
        };

        headerBind();
        function headerBind() {
            arrow.style.left = headerLis[0].getBoundingClientRect().left
                + headerLis[0].offsetWidth/2 - arrow.offsetWidth/2 + "px";
            downs[0].style.width = "100%";
            for(var i=0 ;i<headerLis.length ;i++){
                headerLis[i].index = i;
                headerLis[i].onclick = function () {

                    prevIndex = now;
                    now = this.index;
                    if(prevIndex==now){
                        return;
                    }
                    move(this.index);


                };

              for(var j = 0 ;j<menuListLi.length;j++){
                  menuListLi[j].index = j;
                  menuListLi[j].onclick = function () {

                      prevIndex = now;
                      now = this.index;
                      if(prevIndex==now){
                          return;
                      }
                      move(this.index);

                  }
              }

            }
        }


        function move(index) {
            for(var j = 0; j < downs.length;j++){
                downs[j].style.width ="";
            }
            downs[index].style.width = "100%";
            arrow.style.left = headerLis[index].getBoundingClientRect().left
                + headerLis[index].offsetWidth/2 - arrow.offsetWidth/2 + "px";

            list.style.top = -index * (document.documentElement.clientHeight - header.offsetHeight) + "px";
            for(var i=0 ;i<menuListLi.length ;i++){
                menuListLi[i].className = "";

            }
            menuListLi[index].className = "active";


            if(animation[index]&&animation[index]["inAni"]){
                animation[index].inAni();

            }
            if(animation[prevIndex]&&animation[prevIndex]["outAni"]){
                animation[prevIndex].outAni();

            }
        }


        contentBind();
        function contentBind() {
            content.style.height = document.documentElement.clientHeight - header.offsetHeight + "px";
            for(var i = 0 ;i < contentLi.length ;i++){
                contentLi[i].style.height = document.documentElement.clientHeight - header.offsetHeight + "px";
            }
        }



    }
</script>
</body>
</html>
